#!/bin/bash
#
# Script of automatically running pylint
#
# Copyright 2016 bb8 Authors

SCRIPT_DIR=$(dirname "$0")

GIT_ROOT=$SCRIPT_DIR/..

git fetch origin
TARGET_BRANCH=$(git merge-base --fork-point origin/dev HEAD)

SOURCES=$(git diff $TARGET_BRANCH --stat | awk '{ print $1 }' | grep '\.py')

cd $GIT_ROOT
pep8 $SOURCES
pylint --rcfile=$SCRIPT_DIR/pylintrc \
  --msg-template='{path}:{line}: {msg_id}: {msg}' $SOURCES
